/*! sannico 2016-09-19 */
var app=angular.module("app",["ngRoute","ngMaterial","ngCookies"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"homeCtrl"}).when("/nosotros",{templateUrl:"views/nosotros.html",controller:"nosotrosCtrl"}).when("/cronograma",{templateUrl:"views/cronograma.html",controller:"cronogramaCtrl"}).when("/docentes",{templateUrl:"views/docentes.html",controller:"docentesCtrl"}).when("/galeria",{templateUrl:"views/galeria.html",controller:"galeriaCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"loginCtrl"}).when("/evento/:idEvento",{templateUrl:"views/evento.html",controller:"eventoCtrl"}).when("/album/:idAlbum",{templateUrl:"views/album.html",controller:"albumCtrl"}).when("/dashboard/:idUser",{templateUrl:"views/dashboard.html",controller:"dashboardCtrl"}).when("/docentes_adm",{templateUrl:"views/docentes_adm.html",controller:"docentesAdmCtrl"}).when("/perfil_edit/:guid",{templateUrl:"views/perfil_edit.html",controller:"perfilEditCtrl"}).when("/alumnos",{templateUrl:"views/alumnos.html",controller:"alumnosCtrl"}).when("/asignatura/:idAsignatura/:idAlumno",{templateUrl:"views/asignatura.html",controller:"asignaturaCtrl"}).when("/asignaturas",{templateUrl:"views/asignaturas.html",controller:"asignaturasCtrl"}).when("/adm_asignatura/:id",{templateUrl:"views/adm_asignatura.html",controller:"admAsignaturaCtrl"}).when("/calificar/:id",{templateUrl:"views/calificar.html",controller:"calificarCtrl"}).when("/acudientes",{templateUrl:"views/acudientes.html",controller:"acudientesCtrl"}).when("/cronograma_adm",{templateUrl:"views/cronograma_adm.html",controller:"cronogramaAdmCtrl"}).when("/galerias_adm",{templateUrl:"views/galerias_adm.html",controller:"galeriasAdmCtrl"}).when("/galeria_adm/:id",{templateUrl:"views/galeria_adm.html",controller:"galeriaAdmCtrl"}).when("/app_adm",{templateUrl:"views/app_adm.html",controller:"appAdmCtrl"}).otherwise({redirectTo:"/"})}]),app.controller("appCtrl",["$scope","$http","$cookies","$location",function(a,b,c,d){a.loggedIn=c.get("logued"),a.logued=function(){a.loggedIn=c.get("logued"),a.callAvatar(),a.callRol(),d.path("/dashboard/1")},a.logout=function(){a.loggedIn="",c.put("logued",""),d.path("/login")},a.callAvatar=function(){b.post("servicios/avatar.php",{guid:c.get("logued")}).success(function(b){""!==b&&(a.avatar=b[0].avatar)}).error(function(){a.user="Error: No hay Datos"})},a.callRol=function(){b.post("servicios/rol.php",{guid:c.get("logued")}).success(function(b){a.rol=b[0].rol}).error(function(){a.rol=0})}}]),app.controller("homeCtrl",["$scope",function(a){}]),app.controller("headerCtrl",["$scope",function(a){}]),app.controller("footerCtrl",["$scope",function(a){}]),app.controller("nosotrosCtrl",["$scope",function(a){}]),app.controller("cronogramaCtrl",["$scope",function(a){}]),app.controller("docentesCtrl",["$scope",function(a){}]),app.controller("galeriaCtrl",["$scope",function(a){}]),app.controller("loginCtrl",["$scope","$location","$http","$cookies",function(a,b,c,d){a.login=function(){a.error="",a.email&&a.password?c.post("servicios/login.php",{email:a.email,password:a.password}).success(function(b){if(b.error)a.error=b.error;else{var c=b.guid;b.rol;d.put("logued",c),a.callAvatar(),a.logued()}}).error(function(b,c){a.errors.push(c)}):(a.error="Por favor ingrese los datos",a.login=!1)}}]),app.controller("eventoCtrl",["$scope",function(a){}]),app.controller("albumCtrl",["$scope",function(a){}]),app.controller("dashboardCtrl",["$scope",function(a){}]),app.controller("docentesAdmCtrl",["$scope","$mdDialog","$mdMedia","person","$http",function(a,b,c,d,e){var f;a.openMenu=function(a,b){f=b,a(b)},a.addTeacher=function(c,e){d.setPerson(e),b.show({controller:"addPersonCtrl",templateUrl:"views/add_person.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initDocentes()},function(){a.initDocentes()})},a.initDocentes=function(){e.post("servicios/readDocentes.php").success(function(b){if(b.error)a.error=b.error;else{a.docentes=b,a.edad=function(a){return fecha=new Date(a),hoy=new Date,ed=parseInt((hoy-fecha)/365/24/60/60/1e3),ed};for(var c=0;c<b.length;c++){var d=a.docentes[c],e=b[c];d.nombres=e.nombres,d.apellidos=e.apellidos,d.edad=a.edad(e.nacimiento)}}}).error(function(){a.misEmpresas="Error: No hay Datos"})},a.initDocentes()}]),app.controller("perfilEditCtrl",["$scope","$routeParams","$http",function(a,b,c){a.guid=b.guid,a.tipoDoc=[{name:"T.I."},{name:"C.C."}],a.initPerson=function(){c.post("servicios/readPerson.php",{guid:a.guid}).success(function(b){b.error?a.error=b.error:(a.nombres=b.nombres,a.apellidos=b.apellidos)}).error(function(){a.error="Error: No hay Datos"})},a.initPerson()}]),app.controller("addPersonCtrl",["$scope","$mdDialog","person","guid","$http",function(a,b,c,d,e){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),d=d.createGuid(),a.addPerson=function(b){a.error="";var c=!0,f=!0,g=0;g="Alumno"===b?3:"Docente"===b?2:"Acudiente"===b?4:0,"Alumno"===b&&(a.grado&&a.codigo||(c=!1),a.email||(a.email="")),"Alumno"!==b&&(a.grado="",a.codigo="",a.email||(f=!1)),isValidEmail=function(a){return/^\w+([\.\+\-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(a)},a.nombres&&a.apellidos&&a.Fnacimiento&&a.genero&&f&&c&&d?(a.pass=Math.random().toString(36).slice(-8),""===a.email||isValidEmail(a.email)?e.post("servicios/insertPerson.php",{rol:g,nombres:a.nombres,apellidos:a.apellidos,Fnacimiento:a.Fnacimiento,genero:a.genero,email:a.email,grado:a.grado,guid:d,pass:a.pass,codigo:a.codigo}).success(function(c){c.error?a.error=c.error:a.success="El "+b+" se creó correctamente"}):a.error="El Email es incorrecto"):a.error="Todos los campos son obligatorios"}}]),app.controller("alumnosCtrl",["$scope","$mdDialog","$mdMedia","person","$http",function(a,b,c,d,e){var f;a.openMenu=function(a,b){f=b,a(b)},a.addTeacher=function(c,e){d.setPerson(e),b.show({controller:"addPersonCtrl",templateUrl:"views/add_person.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initAlumnos()},function(){a.initAlumnos()})},a.initAlumnos=function(){e.post("servicios/readAlumnos.php").success(function(b){b.error?a.error=b.error:a.alumnos=b}).error(function(){a.error="Error: No hay Datos"})},a.initAlumnos()}]),app.controller("asignaturaCtrl",["$scope","$mdMedia","$mdDialog","person",function(a,b,c,d){a.openMenu=function(a,b){originatorEv=b,a(b)},a.edit=function(b,e){d.setPerson(e),c.show({controller:"editNoteCtrl",templateUrl:"views/edit_note.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})}}]),app.controller("asignaturasCtrl",["$scope",function(a){}]),app.controller("editNoteCtrl",["$scope","$mdDialog","person",function(a,b,c){a.cancel=function(){b.cancel()},a.typeEdit=c.getPerson()}]),app.controller("admAsignaturaCtrl",["$scope","$mdMedia","$mdDialog","person",function(a,b,c,d){a.openMenu=function(a,b){originatorEv=b,a(b)},a.edit=function(b,e){d.setPerson(e),c.show({controller:"editTareaCtrl",templateUrl:"views/edit_tarea.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})},a.state="Al",a.setState=function(b){a.state=b}}]),app.controller("editTareaCtrl",["$scope","$mdDialog","person",function(a,b,c){a.cancel=function(){b.cancel()},a.typeEdit=c.getPerson()}]),app.controller("calificarCtrl",["$scope",function(a){}]),app.controller("acudientesCtrl",["$scope","$mdDialog","$mdMedia","person","$http",function(a,b,c,d,e){var f;a.openMenu=function(a,b){f=b,a(b)},a.addAcudiente=function(c,e){d.setPerson(e),b.show({controller:"addPersonCtrl",templateUrl:"views/add_person.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initAcudientes()},function(){a.initAcudientes()})},a.initAcudientes=function(){e.post("servicios/readAcudientes.php").success(function(b){b.error?a.error=b.error:a.acudientes=b}).error(function(){a.error="Error: No hay Datos"})},a.initAcudientes()}]),app.controller("cronogramaAdmCtrl",["$scope","$mdDialog","$mdMedia","person","$http",function(a,b,c,d,e){var f;a.openMenu=function(a,b){f=b,a(b)},a.addEvent=function(c,e){d.setPerson(e),b.show({controller:"addEventCtrl",templateUrl:"views/add_event.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initEventos()},function(){a.initEventos()})},a.editEvent=function(c,e){d.setPerson(e),b.show({controller:"editEventCtrl",templateUrl:"views/edit_event.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initEventos()},function(){a.initEventos()})},a.deleteEvent=function(c,d){var f=b.confirm().title("Quieres Borrar el Evento?").textContent("Este Evento se borrrá para siempre").ariaLabel("Lucky day").targetEvent(c).ok("ELIMINAR").cancel("CANCELAR");b.show(f).then(function(){e.post("servicios/deleteEvent.php",{idEvento:d}).success(function(b){a.initEventos()})},function(){})},a.initEventos=function(){e.post("servicios/readEventos.php").success(function(b){b.error?a.error=b.error:a.eventos=b}).error(function(){a.error="Error: No hay Datos"})},a.initEventos()}]),app.controller("addEventCtrl",["$scope","$mdDialog","person","$http",function(a,b,c,d){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),a.addEvent=function(){if(a.error="","Crear"===a.typePerson)if(a.titulo,a.fecha,a.hora,a.lugar,a.imgEvent,a.descripcion){var b="",c="",e=0;if(a.imgEvent&&(b=a.imgEvent),""!==b){var f=new Image;f.src=b,f.addEventListener("load",function(){width=f.width,height=f.height}),c=11===a.imgEvent.indexOf("jpg")?"jpg":11===a.imgEvent.indexOf("jpeg")?"jpeg":11===a.imgEvent.indexOf("png")?"png":11===a.imgEvent.indexOf("gif")?"gif":0,0!==c?600===f.width&&400===f.height?e=1:(a.error="El tamaño de la imágen debe ser de 600px x 400px",a.imgEvent="",b=""):(a.error="Formato de la imágen Inválido",a.imgEvent="",b="")}1===e&&d.post("servicios/insertEvent.php",{titulo:a.titulo,fecha:a.fecha,hora:a.hora,lugar:a.lugar,imagen:b,format:c,descripcion:a.descripcion}).success(function(b){b.error?a.error=b.error:a.success="El Evento se creó correctamente"})}else a.error="Todos los campos son obligatorios"}}]),app.controller("addPhotoCtrl",["$scope","$mdDialog","person","$http",function(a,b,c,d){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),a.uploadPhoto=function(){if(a.error="",a.photo&&a.descripcion){var b="",c="",e=0;if(a.photo&&(b=a.photo),""!==b){var f=new Image;f.src=b,f.addEventListener("load",function(){width=f.width,height=f.height}),c=11===a.photo.indexOf("jpg")?"jpg":11===a.photo.indexOf("jpeg")?"jpeg":11===a.photo.indexOf("png")?"png":11===a.photo.indexOf("gif")?"gif":0,0!==c?f.width<=1024&&f.height<=850?e=1:(a.error="El tamaño de la imágen es muy grande",a.photo="",b=""):(a.error="Formato de la imágen Inválido",a.photo="",b="")}1===e&&d.post("servicios/uploadPhoto.php",{imagen:b,format:c,descripcion:a.descripcion,idGaleria:a.typePerson}).success(function(b){b.error?a.error=b.error:a.success="La foto se agregó correctamente"})}else a.error="Todos los campos son obligatorios"}}]),app.controller("addPeriodoCtrl",["$scope","$mdDialog","person",function(a,b,c){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson()}]),app.controller("galeriasAdmCtrl",["$scope","$mdDialog","$mdMedia","person","$http",function(a,b,c,d,e){var f;a.openMenu=function(a,b){f=b,a(b)},a.addGallery=function(c,e){d.setPerson(e),b.show({controller:"addGaleriaCtrl",templateUrl:"views/add_galeria.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initGalerias()},function(){a.initGalerias()})},a.editGallery=function(c,e){d.setPerson(e),b.show({controller:"editGaleriaCtrl",templateUrl:"views/edit_galeria.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initGalerias()},function(){a.initGalerias()})},a.deleteGallery=function(c,d){var f=b.confirm().title("Quieres Eliminar la Galería?").textContent("Si la eliminas, se perderán todas las fotos que tienes dentro de esta galería").ariaLabel("Lucky day").targetEvent(c).ok("ELIMINAR").cancel("CANCELAR");b.show(f).then(function(){e.post("servicios/deleteGallery.php",{idGallery:d}).success(function(b){a.initGalerias()})},function(){})},a.initGalerias=function(){e.post("servicios/readGallery.php").success(function(b){b.error?a.error=b.error:a.galerias=b})},a.initGalerias()}]),app.controller("galeriaAdmCtrl",["$scope","$mdDialog","$mdMedia","person","$routeParams","$http",function(a,b,c,d,e,f){var g,h=e.id;a.openMenu=function(a,b){g=b,a(b)},a.addPhoto=function(c,e){d.setPerson(e),b.show({controller:"addPhotoCtrl",templateUrl:"views/add_photo.html",parent:angular.element(document.body),targetEvent:c,clickOutsideToClose:!0}).then(function(b){a.initPhotos()},function(){a.initPhotos()})},a.initPhotos=function(){f.post("servicios/readPhotos.php",{id:h}).success(function(b){b.error?a.error=b.error:a.photos=b}),f.post("servicios/readGaleria.php",{id:h}).success(function(b){b.error?a.error=b.error:a.galeria=b})},a.initPhotos()}]),app.controller("addGaleriaCtrl",["$scope","$mdDialog","person","$http",function(a,b,c,d){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),a.addGallery=function(){a.error="","Crear"===a.typePerson&&(a.titulo&&a.descripcion?d.post("servicios/insertGallery.php",{titulo:a.titulo,descripcion:a.descripcion}).success(function(b){b.error?a.error=b.error:a.success="La galería se creó correctamente"}):a.error="Todos los campos son obligatorios")}}]),app.controller("editEventCtrl",["$scope","$mdDialog","person","$http",function(a,b,c,d){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),a.editEvent=function(){if(a.error="",a.success="",a.titulo&&a.fecha&&a.hora&&a.lugar&&a.descripcion){var b="",c="",e=0;if(a.imgEvent&&(b=a.imgEvent),""!==b){var f=new Image;f.src=b,f.addEventListener("load",function(){width=f.width,height=f.height}),c=11===a.imgEvent.indexOf("jpg")?"jpg":11===a.imgEvent.indexOf("jpeg")?"jpeg":11===a.imgEvent.indexOf("png")?"png":11===a.imgEvent.indexOf("gif")?"gif":0,0!==c?600===f.width&&400===f.height?e=1:(a.error="El tamaño de la imágen debe ser de 600px x 400px",a.imgEvent="",b=""):(a.error="Formato de la imágen Inválido",a.imgEvent="",b="")}d.post("servicios/updEvent.php",{titulo:a.titulo,fecha:a.fecha,hora:a.hora,lugar:a.lugar,imagen:b,format:c,descripcion:a.descripcion,id:a.typePerson}).success(function(b){"true"===b?a.success="El Evento se editó correctamente":a.error="No se pudo editar el Evento"})}else a.error="Todos los campos son obligatorios"},d.post("servicios/readEvento.php",{id:a.typePerson}).success(function(b){b.error?a.error=b.error:(a.titulo=b.titulo,a.hora=b.hora,a.lugar=b.lugar,a.descripcion=b.descripcion)})}]),app.controller("appAdmCtrl",["$scope","$mdMedia","$mdDialog","person",function(a,b,c,d){a.openMenu=function(a,b){originatorEv=b,a(b)},a.edit=function(b,e){d.setPerson(e),c.show({controller:"addPeriodoCtrl",templateUrl:"views/add_periodo.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0}).then(function(b){a.status='You said the information was "'+b+'".'},function(){a.status="You cancelled the dialog."})}}]),app.controller("editGaleriaCtrl",["$scope","$mdDialog","person","$http",function(a,b,c,d){a.cancel=function(){b.cancel()},a.typePerson=c.getPerson(),a.editGaleria=function(){a.error="",a.success="",a.titulo&&a.descripcion?d.post("servicios/updGallery.php",{titulo:a.titulo,descripcion:a.descripcion,id:a.typePerson}).success(function(b){"true"===b?a.success="La Galería se editó correctamente":a.error="No se pudo editar la Galería"}):a.error="Todos los campos son obligatorios"},d.post("servicios/readGaleria.php",{id:a.typePerson}).success(function(b){b.error?a.error=b.error:(a.id=b.id,a.titulo=b.titulo,a.descripcion=b.descripcion)})}]),app.directive("header",function(){return{restrict:"A",templateUrl:"views/header.html",controller:"headerCtrl"}}),app.directive("footer",function(){return{restrict:"A",templateUrl:"views/footer.html",controller:"footerCtrl"}}),app.directive("gallery",function(){return{restrict:"A",link:function(a,b,c){$(".gallery a").simpleLightbox()}}}),app.directive("tabs",function(){return{restrict:"A",link:function(a,b,c){var d=b.find("a");$(d).click(function(a){a.preventDefault(),$(this).tab("show")})}}}),app.directive("backButton",function(){return{restrict:"A",link:function(a,b,c){function d(){history.back(),a.$apply()}b.bind("click",d)}}}),app.directive("fileread",[function(){return{scope:{fileread:"="},link:function(a,b,c){b.bind("change",function(b){var c=new FileReader;c.onload=function(b){a.$apply(function(){a.fileread=b.target.result})},c.readAsDataURL(b.target.files[0])})}}}]),app.service("person",function(){var a;this.setPerson=function(b){return a=b},this.getPerson=function(){return a?a:""}}),app.service("guid",function(){this.createGuid=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}});